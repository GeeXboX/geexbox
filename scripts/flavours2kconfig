#!/bin/sh

cat > config/Kconfig.flavours <<EOF
############################################
# This file is autogenerated, do not edit! #
############################################

choice FLAVOUR
  prompt "Flavour"
  default FLAVOUR_geexbox

EOF

flavours=`ls -d config/flavours/* | sed s:config/flavours/:: | xargs`

for flavour in $flavours; do
  . config/flavours/$flavour/meta
  cat >> config/Kconfig.flavours <<EOF
config FLAVOUR_${FLAVOUR_NAME}
  bool "${FLAVOUR_SHORTDESC}"
EOF
  for pkg in $FLAVORS_DEPENDS; do
    echo "  select PKG_${pkg}" >> config/Kconfig.flavours
  done
  cat >> config/Kconfig.flavours <<EOF
  help
`echo "$FLAVOUR_LONGDESC" | fmt | sed 's/^/    /g'`
EOF
  echo >> config/Kconfig.flavours
done

cat >> config/Kconfig.flavours <<EOF
endchoice

config GX_FLAVOUR
  string
EOF

for flavour in $flavours; do
  echo "  default "$flavour" if FLAVOUR_${flavour}" >> config/Kconfig.flavours
done
