From 9fdc9cf9f63c1fc0e96ed7c7a2a7622e3f359d52 Mon Sep 17 00:00:00 2001
From: huceke <gimli@i7.(none)>
Date: Tue, 20 Mar 2012 19:08:24 +0100
Subject: [PATCH 10/17] [dove] added crosscompile helpers.

---
 tools/marvell-dove/Makefile.include                |   13 +++++
 tools/marvell-dove/depends/Makefile                |   37 +++++++++++++
 tools/marvell-dove/depends/autoconf/.gitignore     |    1 +
 tools/marvell-dove/depends/autoconf/Makefile       |   41 +++++++++++++++
 tools/marvell-dove/depends/automake/.gitignore     |    1 +
 tools/marvell-dove/depends/automake/Makefile       |   41 +++++++++++++++
 tools/marvell-dove/depends/boost/.gitignore        |    1 +
 tools/marvell-dove/depends/boost/Makefile          |   32 ++++++++++++
 .../depends/boost/user-config.jam-arm.in           |    4 ++
 tools/marvell-dove/depends/cmake/.gitignore        |    1 +
 tools/marvell-dove/depends/cmake/Makefile          |   41 +++++++++++++++
 tools/marvell-dove/depends/depends.mk              |   54 ++++++++++++++++++++
 tools/marvell-dove/depends/fribidi/.gitignore      |    1 +
 tools/marvell-dove/depends/fribidi/Makefile        |   42 +++++++++++++++
 tools/marvell-dove/depends/help2man/.gitignore     |    1 +
 tools/marvell-dove/depends/help2man/Makefile       |   40 ++++++++++++++
 tools/marvell-dove/depends/jasper/.gitignore       |    1 +
 tools/marvell-dove/depends/jasper/Makefile         |   43 ++++++++++++++++
 tools/marvell-dove/depends/libass/.gitignore       |    1 +
 tools/marvell-dove/depends/libass/Makefile         |   41 +++++++++++++++
 tools/marvell-dove/depends/libbluray/.gitignore    |    1 +
 tools/marvell-dove/depends/libbluray/Makefile      |   40 ++++++++++++++
 tools/marvell-dove/depends/libcdio/.gitignore      |    1 +
 tools/marvell-dove/depends/libcdio/Makefile        |   42 +++++++++++++++
 .../marvell-dove/depends/libjpeg-turbo/.gitignore  |    1 +
 tools/marvell-dove/depends/libjpeg-turbo/Makefile  |   41 +++++++++++++++
 tools/marvell-dove/depends/liblzo2/.gitignore      |    1 +
 tools/marvell-dove/depends/liblzo2/Makefile        |   41 +++++++++++++++
 tools/marvell-dove/depends/libmodplug/.gitignore   |    1 +
 tools/marvell-dove/depends/libmodplug/Makefile     |   41 +++++++++++++++
 tools/marvell-dove/depends/libnfs/.gitignore       |    1 +
 .../depends/libnfs/001_fix_hanewin.patch           |   12 ++++
 tools/marvell-dove/depends/libnfs/Makefile         |   42 +++++++++++++++
 tools/marvell-dove/depends/librtmp/.gitignore      |    1 +
 tools/marvell-dove/depends/librtmp/Makefile        |   40 ++++++++++++++
 tools/marvell-dove/depends/librtmp/prefix.patch    |   21 ++++++++
 tools/marvell-dove/depends/libtool/.gitignore      |    1 +
 tools/marvell-dove/depends/libtool/Makefile        |   41 +++++++++++++++
 tools/marvell-dove/depends/patchelf/.gitignore     |    1 +
 tools/marvell-dove/depends/patchelf/Makefile       |   41 +++++++++++++++
 tools/marvell-dove/depends/pkg-config/.gitignore   |    1 +
 tools/marvell-dove/depends/pkg-config/Makefile     |   42 +++++++++++++++
 tools/marvell-dove/depends/tiff/.gitignore         |    1 +
 tools/marvell-dove/depends/tiff/Makefile           |   41 +++++++++++++++
 tools/marvell-dove/depends/xbmc/Makefile           |   31 +++++++++++
 tools/marvell-dove/depends/yajl/.gitignore         |    1 +
 tools/marvell-dove/depends/yajl/Makefile           |   41 +++++++++++++++
 tools/marvell-dove/setup-sdk.sh                    |   41 +++++++++++++++
 48 files changed, 1047 insertions(+), 0 deletions(-)
 create mode 100644 tools/marvell-dove/Makefile.include
 create mode 100644 tools/marvell-dove/depends/Makefile
 create mode 100644 tools/marvell-dove/depends/autoconf/.gitignore
 create mode 100644 tools/marvell-dove/depends/autoconf/Makefile
 create mode 100644 tools/marvell-dove/depends/automake/.gitignore
 create mode 100644 tools/marvell-dove/depends/automake/Makefile
 create mode 100644 tools/marvell-dove/depends/boost/.gitignore
 create mode 100644 tools/marvell-dove/depends/boost/.installed
 create mode 100644 tools/marvell-dove/depends/boost/Makefile
 create mode 100644 tools/marvell-dove/depends/boost/user-config.jam-arm.in
 create mode 100644 tools/marvell-dove/depends/cmake/.gitignore
 create mode 100644 tools/marvell-dove/depends/cmake/Makefile
 create mode 100755 tools/marvell-dove/depends/depends.mk
 create mode 100644 tools/marvell-dove/depends/fribidi/.gitignore
 create mode 100644 tools/marvell-dove/depends/fribidi/.installed
 create mode 100644 tools/marvell-dove/depends/fribidi/Makefile
 create mode 100644 tools/marvell-dove/depends/help2man/.gitignore
 create mode 100644 tools/marvell-dove/depends/help2man/Makefile
 create mode 100644 tools/marvell-dove/depends/jasper/.gitignore
 create mode 100644 tools/marvell-dove/depends/jasper/.installed
 create mode 100644 tools/marvell-dove/depends/jasper/Makefile
 create mode 100644 tools/marvell-dove/depends/libass/.gitignore
 create mode 100644 tools/marvell-dove/depends/libass/.installed
 create mode 100644 tools/marvell-dove/depends/libass/Makefile
 create mode 100644 tools/marvell-dove/depends/libbluray/.gitignore
 create mode 100644 tools/marvell-dove/depends/libbluray/.installed
 create mode 100644 tools/marvell-dove/depends/libbluray/Makefile
 create mode 100644 tools/marvell-dove/depends/libcdio/.gitignore
 create mode 100644 tools/marvell-dove/depends/libcdio/.installed
 create mode 100644 tools/marvell-dove/depends/libcdio/Makefile
 create mode 100644 tools/marvell-dove/depends/libjpeg-turbo/.gitignore
 create mode 100644 tools/marvell-dove/depends/libjpeg-turbo/.installed
 create mode 100644 tools/marvell-dove/depends/libjpeg-turbo/Makefile
 create mode 100644 tools/marvell-dove/depends/liblzo2/.gitignore
 create mode 100644 tools/marvell-dove/depends/liblzo2/Makefile
 create mode 100644 tools/marvell-dove/depends/libmodplug/.gitignore
 create mode 100644 tools/marvell-dove/depends/libmodplug/.installed
 create mode 100644 tools/marvell-dove/depends/libmodplug/Makefile
 create mode 100644 tools/marvell-dove/depends/libnfs/.gitignore
 create mode 100644 tools/marvell-dove/depends/libnfs/.installed
 create mode 100644 tools/marvell-dove/depends/libnfs/001_fix_hanewin.patch
 create mode 100644 tools/marvell-dove/depends/libnfs/Makefile
 create mode 100644 tools/marvell-dove/depends/librtmp/.gitignore
 create mode 100644 tools/marvell-dove/depends/librtmp/.installed
 create mode 100644 tools/marvell-dove/depends/librtmp/Makefile
 create mode 100644 tools/marvell-dove/depends/librtmp/prefix.patch
 create mode 100644 tools/marvell-dove/depends/libtool/.gitignore
 create mode 100644 tools/marvell-dove/depends/libtool/Makefile
 create mode 100644 tools/marvell-dove/depends/patchelf/.gitignore
 create mode 100644 tools/marvell-dove/depends/patchelf/Makefile
 create mode 100644 tools/marvell-dove/depends/pkg-config/.gitignore
 create mode 100644 tools/marvell-dove/depends/pkg-config/Makefile
 create mode 100644 tools/marvell-dove/depends/tiff/.gitignore
 create mode 100644 tools/marvell-dove/depends/tiff/.installed
 create mode 100644 tools/marvell-dove/depends/tiff/Makefile
 create mode 100755 tools/marvell-dove/depends/xbmc/Makefile
 create mode 100644 tools/marvell-dove/depends/yajl/.gitignore
 create mode 100644 tools/marvell-dove/depends/yajl/.installed
 create mode 100644 tools/marvell-dove/depends/yajl/Makefile
 create mode 100755 tools/marvell-dove/setup-sdk.sh

diff --git a/tools/marvell-dove/Makefile.include b/tools/marvell-dove/Makefile.include
new file mode 100644
index 0000000..f162833
--- /dev/null
+++ b/tools/marvell-dove/Makefile.include
@@ -0,0 +1,13 @@
+SDKSTAGE=/opt/xbmc-cubox/buildroot/output/staging
+XBMCPREFIX=/opt/xbmc-cubox/xbmc-bin
+TARGETFS=/opt/xbmc-cubox/buildroot/output/target
+TOOLCHAIN=/opt/xbmc-cubox/buildroot/output/host/usr/
+BUILDROOT=/opt/xbmc-cubox/buildroot
+USE_BUILDROOT=1
+BASE_URL=http://mirrors.xbmc.org/build-deps/darwin-libs
+TARBALLS_LOCATION=/opt/xbmc-tarballs
+RETRIEVE_TOOL=/usr/bin/curl
+RETRIEVE_TOOL_FLAGS=-Ls --create-dirs --output $(TARBALLS_LOCATION)/$(ARCHIVE)
+ARCHIVE_TOOL=/bin/tar
+ARCHIVE_TOOL_FLAGS=xf
+JOBS=7
diff --git a/tools/marvell-dove/depends/Makefile b/tools/marvell-dove/depends/Makefile
new file mode 100644
index 0000000..591fddb
--- /dev/null
+++ b/tools/marvell-dove/depends/Makefile
@@ -0,0 +1,37 @@
+include ../Makefile.include
+
+ifeq ($(USE_BUILDROOT),1)
+	BUILDTOOLS = 
+	SUBDIRS = libjpeg-turbo tiff jasper fribidi libass libmodplug libcdio librtmp libbluray libnfs yajl boost xbmc
+else
+	BUILDTOOLS = help2man autoconf automake libtool pkg-config yasm cmake patchelf
+	SUBDIRS = liblzo2 tiff libnfs jasper xbmc
+endif
+
+IMAGENAME = xbmc-rbp-`date +'%y%m%d'`
+
+.PHONY: buildtools subdirs
+
+all: buildtools subdirs
+
+buildtools:
+	for d in $(BUILDTOOLS); do $(MAKE) -C $$d; done
+
+subdirs:
+	for d in $(SUBDIRS); do $(MAKE) -C $$d; done
+
+clean:
+	for d in $(BUILDTOOLS); do $(MAKE) -C $$d clean; done
+	for d in $(SUBDIRS); do $(MAKE) -C $$d clean; done
+
+distclean::
+	for d in $(BUILDTOOLS); do $(MAKE) -C $$d distclean; done
+	for d in $(SUBDIRS); do $(MAKE) -C $$d distclean; done
+	rm -rf $(XBMCPREFIX)
+
+image:
+	make -C $(BUILDROOT) tarroot IMAGE=$(CURDIR)/$(IMAGENAME) TAR_COMPRESSOR=
+	echo "S111xbmc S110rc.local" | cat $(TARGETFS)/etc/init.d/rc.deps - > $(CURDIR)/packaging/etc/init.d/rc.deps
+	cd packaging; tar -uf $(CURDIR)/$(IMAGENAME).tar *
+	tar -uf $(CURDIR)/$(IMAGENAME).tar $(XBMCPREFIX) 
+	gzip $(IMAGENAME).tar
diff --git a/tools/marvell-dove/depends/autoconf/.gitignore b/tools/marvell-dove/depends/autoconf/.gitignore
new file mode 100644
index 0000000..e832e48
--- /dev/null
+++ b/tools/marvell-dove/depends/autoconf/.gitignore
@@ -0,0 +1 @@
+autoconf-2.63
diff --git a/tools/marvell-dove/depends/autoconf/Makefile b/tools/marvell-dove/depends/autoconf/Makefile
new file mode 100644
index 0000000..2a5ca9e
--- /dev/null
+++ b/tools/marvell-dove/depends/autoconf/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+
+# lib name, version
+LIBNAME=autoconf
+VERSION=2.63
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+export PREFIX=$(XBMCPREFIX)
+export PATH:=$(PREFIX)/bin:$(PATH)
+CONFIGURE=./configure --prefix=$(PREFIX)
+
+LIBDYLIB=$(SOURCE)/bin/autoconf
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/automake/.gitignore b/tools/marvell-dove/depends/automake/.gitignore
new file mode 100644
index 0000000..409d7e1
--- /dev/null
+++ b/tools/marvell-dove/depends/automake/.gitignore
@@ -0,0 +1 @@
+automake-1.10.3
diff --git a/tools/marvell-dove/depends/automake/Makefile b/tools/marvell-dove/depends/automake/Makefile
new file mode 100644
index 0000000..38c5d64
--- /dev/null
+++ b/tools/marvell-dove/depends/automake/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+
+# lib name, version
+LIBNAME=automake
+VERSION=1.10.3
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+export PREFIX=$(XBMCPREFIX)
+export PATH:=$(PREFIX)/bin:$(PATH)
+CONFIGURE=./configure --prefix=$(PREFIX)
+
+LIBDYLIB=$(SOURCE)/bin/automake
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/boost/.gitignore b/tools/marvell-dove/depends/boost/.gitignore
new file mode 100644
index 0000000..d89e0c7
--- /dev/null
+++ b/tools/marvell-dove/depends/boost/.gitignore
@@ -0,0 +1 @@
+boost_1_44_0
diff --git a/tools/marvell-dove/depends/boost/.installed b/tools/marvell-dove/depends/boost/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/boost/Makefile b/tools/marvell-dove/depends/boost/Makefile
new file mode 100644
index 0000000..9c19293
--- /dev/null
+++ b/tools/marvell-dove/depends/boost/Makefile
@@ -0,0 +1,32 @@
+include ../../Makefile.include
+include ../depends.mk
+
+LIBNAME=boost
+VERSION=1_44_0
+SOURCE=$(LIBNAME)_$(VERSION)
+ARCHIVE=$(SOURCE).tar.bz2
+
+export PATH:=$(TOOLCHAIN)/bin:$(PATH)
+
+all: .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+.installed: $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cat user-config.jam-arm.in > $(SOURCE)/tools/build/v2/user-config.jam
+	sed -e 's:arm-unknown-linux-gnueabi:$(HOST):g' -i $(SOURCE)/tools/build/v2/user-config.jam
+	cd $(SOURCE); ./bootstrap.sh --prefix=$(PREFIX) --with-libraries=thread
+	cd $(SOURCE); ./bjam --prefix=$(PREFIX) toolset=gcc --toolset-root=$(TOOLCHAIN) --architecture=arm install
+	touch .installed
+
+clean:
+	rm -rf $(SOURCE) .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
+
diff --git a/tools/marvell-dove/depends/boost/user-config.jam-arm.in b/tools/marvell-dove/depends/boost/user-config.jam-arm.in
new file mode 100644
index 0000000..7af27c8
--- /dev/null
+++ b/tools/marvell-dove/depends/boost/user-config.jam-arm.in
@@ -0,0 +1,4 @@
+using gcc : : arm-unknown-linux-gnueabi-g++ :
+  <cflags>"-fvisibility-inlines-hidden -DBOOST_AC_USE_PTHREADS -DBOOST_SP_USE_PTHREADS"
+  <cxxflags>"-fvisibility-inlines-hidden -DBOOST_AC_USE_PTHREADS -DBOOST_SP_USE_PTHREADS"
+;
diff --git a/tools/marvell-dove/depends/cmake/.gitignore b/tools/marvell-dove/depends/cmake/.gitignore
new file mode 100644
index 0000000..5acc817
--- /dev/null
+++ b/tools/marvell-dove/depends/cmake/.gitignore
@@ -0,0 +1 @@
+cmake-2.8.4
diff --git a/tools/marvell-dove/depends/cmake/Makefile b/tools/marvell-dove/depends/cmake/Makefile
new file mode 100644
index 0000000..a081187
--- /dev/null
+++ b/tools/marvell-dove/depends/cmake/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+
+APPNAME=cmake
+VERSION=2.8.4
+SOURCE=$(APPNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+PREFIX:=$(XBMCPREFIX)
+export PATH:=$(PREFIX)/bin:$(PATH)
+CONFIGURE=./bootstrap --prefix=$(PREFIX)
+
+APP=$(SOURCE)/$(APPNAME)
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(APP) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(APP): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/depends.mk b/tools/marvell-dove/depends/depends.mk
new file mode 100755
index 0000000..75dfe6a
--- /dev/null
+++ b/tools/marvell-dove/depends/depends.mk
@@ -0,0 +1,54 @@
+export CFLAGS=-pipe -mabi=aapcs-linux -Wno-psabi -Wa,-mno-warn-deprecated
+ifeq ($(USE_BUILDROOT),1)
+	export HOST=arm-unknown-linux-gnueabi
+	export BUILD=i686-linux
+	export PREFIX=$(XBMCPREFIX)
+	export SYSROOT=$(BUILDROOT)/output/host/usr/arm-unknown-linux-gnueabi/sysroot
+	export CFLAGS+=-I$(XBMCPREFIX)/include -isystem$(SYSROOT)/usr/include -isystem$(SYSROOT)/usr/include -isystem$(PREFIX)/include -isystem$(PREFIX)/usr/include/mysql
+	export CXXFLAGS=$(CFLAGS)
+	export CPPFLAGS=$(CFLAGS)
+	export LDFLAGS=-L$(XBMCPREFIX)/lib
+	export LD=$(TOOLCHAIN)/bin/$(HOST)-ld --sysroot=$(SYSROOT)
+	export CC=$(TOOLCHAIN)/bin/$(HOST)-gcc --sysroot=$(SYSROOT)
+	export CXX=$(TOOLCHAIN)/bin/$(HOST)-g++ --sysroot=$(SYSROOT)
+	export OBJDUMP=$(TOOLCHAIN)/bin/$(HOST)-objdump
+	export RANLIB=$(TOOLCHAIN)/bin/$(HOST)-ranlib
+	export STRIP=$(TOOLCHAIN)/bin/$(HOST)-strip
+	export AR=$(TOOLCHAIN)/bin/$(HOST)-ar
+	export CXXCPP=$(CXX) -E
+	export PKG_CONFIG_PATH=$(PREFIX)/lib/pkgconfig
+	export PYTHON_VERSION=2.7
+	export PATH:=$(PREFIX)/bin:$(BUILDROOT)/output/host/usr/bin:$(PATH)
+	export TEXTUREPACKER_NATIVE_ROOT=/usr
+	export PYTHON_LDFLAGS=-L$(SDKSTAGE)/usr/lib -lpython$(PYTHON_VERSION) -lpthread -ldl -lutil -lm
+else
+	export HOST=arm-bcm2708-linux-gnueabi
+	export BUILD=i686-linux
+	export PREFIX=${XBMCPREFIX}
+	export TARGETFS
+	export SYSROOT=/usr/local/bcm-gcc/arm-bcm2708-linux-gnueabi/sys-root
+	export RLINK_PATH=-Wl,-rpath-link,${SYSROOT}/lib -Wl,-rpath-link,${TARGETFS}/lib -Wl,-rpath-link,${TARGETFS}/usr/lib/
+	export CFLAGS+=-isystem${XBMCPREFIX}/include -isystem${SDKSTAGE}/usr/include
+	export CFLAGS+=-L${XBMCPREFIX}/lib -L${SYSROOT}/lib -L${TARGETFS}/lib -L${TARGETFS}/usr/lib ${RLINK_PATH}
+	export CXXFLAGS=${CFLAGS}
+	export CPPFLAGS=${CFLAGS}
+	export LDFLAGS=${RLINK_PATH} -L${TARGETFS}/lib -L${TARGETFS}/usr/lib -L${XBMCPREFIX}/lib
+	export LD=${TOOLCHAIN}/bin/${HOST}-ld
+	export AR=${TOOLCHAIN}/bin/${HOST}-ar
+	export CC=${TOOLCHAIN}/bin/${HOST}-gcc
+	export CXX=${TOOLCHAIN}/bin/${HOST}-g++
+	export CXXCPP=${CXX} -E
+	export RANLIB=${TOOLCHAIN}/bin/${HOST}-ranlib
+	export STRIP=${TOOLCHAIN}/bin/${HOST}-strip
+	export OBJDUMP=${TOOLCHAIN}/bin/${HOST}-objdump
+	#export ACLOCAL=aclocal -I ${SDKSTAGE}/usr/share/aclocal -I ${TARGETFS}/usr/share/aclocal-1.11
+	export PKG_CONFIG_LIBDIR=${PREFIX}/lib/pkgconfig:${SDKSTAGE}/lib/pkgconfig:${SDKSTAGE}/usr/lib/pkgconfig
+	export PKG_CONFIG_PATH=$(PREFIX)/bin/pkg-config
+	export PYTHON_VERSION=2.6
+	export PATH:=${PREFIX}/bin:$(PATH):${TOOLCHAIN}/bin
+	export TEXTUREPACKER_NATIVE_ROOT=/usr
+	export PYTHON_LDFLAGS=-L$(SDKSTAGE)/usr/lib -lpython$(PYTHON_VERSION)
+endif
+export PYTHON_CPPFLAGS=-I$(SDKSTAGE)/usr/include/python$(PYTHON_VERSION)
+export PYTHON_SITE_PKG=$(SDKSTAGE)/usr/lib/python$(PYTHON_VERSION)/site-packages
+export PYTHON_NOVERSIONCHECK=no-check
diff --git a/tools/marvell-dove/depends/fribidi/.gitignore b/tools/marvell-dove/depends/fribidi/.gitignore
new file mode 100644
index 0000000..46f7c57
--- /dev/null
+++ b/tools/marvell-dove/depends/fribidi/.gitignore
@@ -0,0 +1 @@
+fribidi-0.19.1
diff --git a/tools/marvell-dove/depends/fribidi/.installed b/tools/marvell-dove/depends/fribidi/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/fribidi/Makefile b/tools/marvell-dove/depends/fribidi/Makefile
new file mode 100644
index 0000000..fbb82f0
--- /dev/null
+++ b/tools/marvell-dove/depends/fribidi/Makefile
@@ -0,0 +1,42 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=fribidi
+VERSION=0.19.1
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST) \
+  --disable-docs
+
+LIBDYLIB=$(SOURCE)/.libs/lib$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/help2man/.gitignore b/tools/marvell-dove/depends/help2man/.gitignore
new file mode 100644
index 0000000..eecdd7b
--- /dev/null
+++ b/tools/marvell-dove/depends/help2man/.gitignore
@@ -0,0 +1 @@
+help2man-1.38.2
diff --git a/tools/marvell-dove/depends/help2man/Makefile b/tools/marvell-dove/depends/help2man/Makefile
new file mode 100644
index 0000000..e8e53a5
--- /dev/null
+++ b/tools/marvell-dove/depends/help2man/Makefile
@@ -0,0 +1,40 @@
+include ../../Makefile.include
+
+# lib name, version
+LIBNAME=help2man
+VERSION=1.38.2
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+export PREFIX=$(XBMCPREFIX)
+CONFIGURE=./configure --prefix=$(PREFIX)
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+LIBDYLIB=$(SOURCE)/help2man
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/jasper/.gitignore b/tools/marvell-dove/depends/jasper/.gitignore
new file mode 100644
index 0000000..7030c19
--- /dev/null
+++ b/tools/marvell-dove/depends/jasper/.gitignore
@@ -0,0 +1 @@
+jasper-1.900.1
diff --git a/tools/marvell-dove/depends/jasper/.installed b/tools/marvell-dove/depends/jasper/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/jasper/Makefile b/tools/marvell-dove/depends/jasper/Makefile
new file mode 100644
index 0000000..8898a56
--- /dev/null
+++ b/tools/marvell-dove/depends/jasper/Makefile
@@ -0,0 +1,43 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=jasper
+VERSION=1.900.1
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).zip
+ARCHIVE_TOOL=unzip
+ARCHIVE_TOOL_FLAGS=
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST)
+
+LIBDYLIB=$(SOURCE)/$(LIBNAME)/.libs/$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/libass/.gitignore b/tools/marvell-dove/depends/libass/.gitignore
new file mode 100644
index 0000000..2b21369
--- /dev/null
+++ b/tools/marvell-dove/depends/libass/.gitignore
@@ -0,0 +1 @@
+libass-0.9.11
diff --git a/tools/marvell-dove/depends/libass/.installed b/tools/marvell-dove/depends/libass/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/libass/Makefile b/tools/marvell-dove/depends/libass/Makefile
new file mode 100644
index 0000000..8827462
--- /dev/null
+++ b/tools/marvell-dove/depends/libass/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=libass
+VERSION=0.9.11
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.bz2
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST)
+
+LIBDYLIB=$(SOURCE)/$(LIBNAME)/.libs/$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/libbluray/.gitignore b/tools/marvell-dove/depends/libbluray/.gitignore
new file mode 100644
index 0000000..c08d0a5
--- /dev/null
+++ b/tools/marvell-dove/depends/libbluray/.gitignore
@@ -0,0 +1 @@
+libblueray-20110213.20739ed
diff --git a/tools/marvell-dove/depends/libbluray/.installed b/tools/marvell-dove/depends/libbluray/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/libbluray/Makefile b/tools/marvell-dove/depends/libbluray/Makefile
new file mode 100644
index 0000000..e547956
--- /dev/null
+++ b/tools/marvell-dove/depends/libbluray/Makefile
@@ -0,0 +1,40 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=libblueray
+VERSION=20110213.20739ed
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tgz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --exec-prefix=$(PREFIX) --host=$(HOST)
+
+LIBDYLIB=$(SOURCE)/.libs/$(LIBNAME).so
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	mkdir $(SOURCE)
+	cd $(SOURCE); $(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); ./bootstrap
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/libcdio/.gitignore b/tools/marvell-dove/depends/libcdio/.gitignore
new file mode 100644
index 0000000..d79f4ef
--- /dev/null
+++ b/tools/marvell-dove/depends/libcdio/.gitignore
@@ -0,0 +1 @@
+libcdio-0.82
diff --git a/tools/marvell-dove/depends/libcdio/.installed b/tools/marvell-dove/depends/libcdio/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/libcdio/Makefile b/tools/marvell-dove/depends/libcdio/Makefile
new file mode 100644
index 0000000..24d24b8
--- /dev/null
+++ b/tools/marvell-dove/depends/libcdio/Makefile
@@ -0,0 +1,42 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=libcdio
+VERSION=0.82
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST) 
+
+LIBDYLIB=$(SOURCE)/.libs/(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	cp $(SOURCE)/include/cdio/cdtext.h $(PREFIX)/include/cdio/
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/libjpeg-turbo/.gitignore b/tools/marvell-dove/depends/libjpeg-turbo/.gitignore
new file mode 100644
index 0000000..3debbff
--- /dev/null
+++ b/tools/marvell-dove/depends/libjpeg-turbo/.gitignore
@@ -0,0 +1 @@
+libjpeg-turbo-1.1.1
diff --git a/tools/marvell-dove/depends/libjpeg-turbo/.installed b/tools/marvell-dove/depends/libjpeg-turbo/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/libjpeg-turbo/Makefile b/tools/marvell-dove/depends/libjpeg-turbo/Makefile
new file mode 100644
index 0000000..8e911b3
--- /dev/null
+++ b/tools/marvell-dove/depends/libjpeg-turbo/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=libjpeg-turbo
+VERSION=1.1.1
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(LIBNAME)-$(VERSION).tar.gz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST) \
+  --with-jpeg8
+
+LIBDYLIB=$(SOURCE)/.libs/lib$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/liblzo2/.gitignore b/tools/marvell-dove/depends/liblzo2/.gitignore
new file mode 100644
index 0000000..ef00f81
--- /dev/null
+++ b/tools/marvell-dove/depends/liblzo2/.gitignore
@@ -0,0 +1 @@
+lzo-2.03
diff --git a/tools/marvell-dove/depends/liblzo2/Makefile b/tools/marvell-dove/depends/liblzo2/Makefile
new file mode 100644
index 0000000..7b62706
--- /dev/null
+++ b/tools/marvell-dove/depends/liblzo2/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=lzo
+VERSION=2.03
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST)
+
+LIBDYLIB=$(SOURCE)/src/.libs/lib$(LIBNAME)2.so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/libmodplug/.gitignore b/tools/marvell-dove/depends/libmodplug/.gitignore
new file mode 100644
index 0000000..fd1711b
--- /dev/null
+++ b/tools/marvell-dove/depends/libmodplug/.gitignore
@@ -0,0 +1 @@
+libmodplug-0.8.7
diff --git a/tools/marvell-dove/depends/libmodplug/.installed b/tools/marvell-dove/depends/libmodplug/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/libmodplug/Makefile b/tools/marvell-dove/depends/libmodplug/Makefile
new file mode 100644
index 0000000..5fb6649
--- /dev/null
+++ b/tools/marvell-dove/depends/libmodplug/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=libmodplug
+VERSION=0.8.7
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST)
+
+LIBDYLIB=$(SOURCE)/.libs/$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/libnfs/.gitignore b/tools/marvell-dove/depends/libnfs/.gitignore
new file mode 100644
index 0000000..72f8fd7
--- /dev/null
+++ b/tools/marvell-dove/depends/libnfs/.gitignore
@@ -0,0 +1 @@
+libnfs-0804e67
diff --git a/tools/marvell-dove/depends/libnfs/.installed b/tools/marvell-dove/depends/libnfs/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/libnfs/001_fix_hanewin.patch b/tools/marvell-dove/depends/libnfs/001_fix_hanewin.patch
new file mode 100644
index 0000000..507fbe6
--- /dev/null
+++ b/tools/marvell-dove/depends/libnfs/001_fix_hanewin.patch
@@ -0,0 +1,12 @@
+--- lib/libnfs.c	2011-09-02 12:45:30.000000000 +0200
++++ lib/libnfs.c	2011-12-04 21:16:07.000000000 +0100
+@@ -666,6 +666,9 @@
+ 	if (res->GETATTR3res_u.resok.obj_attributes.type == NF3DIR) {
+ 		st.st_mode |= S_IFDIR ;
+ 	}
++       if (res->GETATTR3res_u.resok.obj_attributes.type == NF3REG) {                                                                                                                                            
++    		st.st_mode |= S_IFREG ;                                                                                                                                                                          
++        } 
+         st.st_nlink   = res->GETATTR3res_u.resok.obj_attributes.nlink;
+         st.st_uid     = res->GETATTR3res_u.resok.obj_attributes.uid;
+         st.st_gid     = res->GETATTR3res_u.resok.obj_attributes.gid;
diff --git a/tools/marvell-dove/depends/libnfs/Makefile b/tools/marvell-dove/depends/libnfs/Makefile
new file mode 100644
index 0000000..852c44e
--- /dev/null
+++ b/tools/marvell-dove/depends/libnfs/Makefile
@@ -0,0 +1,42 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=libnfs
+VERSION=0804e67
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+CONFIGURE=./configure CFLAGS=-D_FILE_OFFSET_BITS=64 --prefix=$(PREFIX) --host=$(HOST)
+
+SO_NAME=$(SOURCE)/lib/libnfs.so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(SO_NAME) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); patch -p0 < ../001_fix_hanewin.patch
+	cd $(SOURCE); ./bootstrap
+	cd $(SOURCE); $(CONFIGURE)
+
+$(SO_NAME): $(SOURCE)
+	make -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+clean:
+	make -C $(SOURCE) clean
+	rm  -f .installed
+	rm -rf $(SOURCE)
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/librtmp/.gitignore b/tools/marvell-dove/depends/librtmp/.gitignore
new file mode 100644
index 0000000..2ca1020
--- /dev/null
+++ b/tools/marvell-dove/depends/librtmp/.gitignore
@@ -0,0 +1 @@
+rtmpdump-2.4
diff --git a/tools/marvell-dove/depends/librtmp/.installed b/tools/marvell-dove/depends/librtmp/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/librtmp/Makefile b/tools/marvell-dove/depends/librtmp/Makefile
new file mode 100644
index 0000000..d866f36
--- /dev/null
+++ b/tools/marvell-dove/depends/librtmp/Makefile
@@ -0,0 +1,40 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=rtmpdump
+VERSION=2.4
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+
+LIBDYLIB=$(SOURCE)/$(LIBNAME)/.libs/$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE)/librtmp; patch -p0 < ../../prefix.patch
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)/librtmp CROSS_COMPILE=$(TOOLCHAIN)/bin/$(HOST)- PREFIX=$(PREFIX) CC="$(CC)" LD="$(LD)"
+
+.installed:
+	make -C $(SOURCE)/librtmp install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/librtmp/prefix.patch b/tools/marvell-dove/depends/librtmp/prefix.patch
new file mode 100644
index 0000000..6c12d06
--- /dev/null
+++ b/tools/marvell-dove/depends/librtmp/prefix.patch
@@ -0,0 +1,21 @@
+--- ../Makefile		2010-06-30 15:58:35.000000000 -0400
++++ ../Makefile.2	2011-03-31 16:19:52.813884882 -0400
+@@ -1,6 +1,6 @@
+ VERSION=v2.3
+ 
+-prefix=/usr/local
++prefix=$(PREFIX)
+ 
+ CC=$(CROSS_COMPILE)gcc
+ LD=$(CROSS_COMPILE)ld
+
+--- Makefile     2010-06-30 15:58:35.000000000 -0400
++++ Makefile.2   2011-03-31 16:19:52.813884882 -0400
+@@ -1,6 +1,6 @@
+ VERSION=v2.3
+
+-prefix=/usr/local
++prefix=$(PREFIX)
+
+ CC=$(CROSS_COMPILE)gcc
+ LD=$(CROSS_COMPILE)ld
diff --git a/tools/marvell-dove/depends/libtool/.gitignore b/tools/marvell-dove/depends/libtool/.gitignore
new file mode 100644
index 0000000..717e6ef
--- /dev/null
+++ b/tools/marvell-dove/depends/libtool/.gitignore
@@ -0,0 +1 @@
+libtool-2.2.6
diff --git a/tools/marvell-dove/depends/libtool/Makefile b/tools/marvell-dove/depends/libtool/Makefile
new file mode 100644
index 0000000..b6edefe
--- /dev/null
+++ b/tools/marvell-dove/depends/libtool/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+
+# lib name, version
+LIBNAME=libtool
+VERSION=2.2.6
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE)a.tar.gz
+
+# configuration settings
+export PREFIX=$(XBMCPREFIX)
+export PATH:=$(PREFIX)/bin:$(PATH)
+CONFIGURE=./configure --prefix=$(PREFIX)
+
+LIBDYLIB=$(SOURCE)/bin/libtool
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/patchelf/.gitignore b/tools/marvell-dove/depends/patchelf/.gitignore
new file mode 100644
index 0000000..28b53ff
--- /dev/null
+++ b/tools/marvell-dove/depends/patchelf/.gitignore
@@ -0,0 +1 @@
+patchelf-0.6pre25969
diff --git a/tools/marvell-dove/depends/patchelf/Makefile b/tools/marvell-dove/depends/patchelf/Makefile
new file mode 100644
index 0000000..7846462
--- /dev/null
+++ b/tools/marvell-dove/depends/patchelf/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+
+# lib name, version
+LIBNAME=patchelf
+VERSION=0.6pre25969
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+export PREFIX=$(XBMCPREFIX)
+export PATH:=$(PREFIX)/bin:$(PATH)
+CONFIGURE=./configure --prefix=$(PREFIX)
+
+LIBDYLIB=$(SOURCE)/src/patchelf
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/pkg-config/.gitignore b/tools/marvell-dove/depends/pkg-config/.gitignore
new file mode 100644
index 0000000..b6b0a86
--- /dev/null
+++ b/tools/marvell-dove/depends/pkg-config/.gitignore
@@ -0,0 +1 @@
+pkg-config-0.23
diff --git a/tools/marvell-dove/depends/pkg-config/Makefile b/tools/marvell-dove/depends/pkg-config/Makefile
new file mode 100644
index 0000000..716e6e3
--- /dev/null
+++ b/tools/marvell-dove/depends/pkg-config/Makefile
@@ -0,0 +1,42 @@
+include ../../Makefile.include
+
+# lib name, version
+# lib name, version
+LIBNAME=pkg-config
+VERSION=0.23
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+PREFIX:=$(XBMCPREFIX)
+export PATH:=$(PREFIX)/bin:$(PATH)
+CONFIGURE=./configure --prefix=$(PREFIX) --enable-indirect-deps --with-pc-path=$(PREFIX)/lib/pkgconfig:$(PREFIX)/share/pkgconfig
+
+LIBDYLIB=$(SOURCE)/bin/pkg-config
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	-rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
diff --git a/tools/marvell-dove/depends/tiff/.gitignore b/tools/marvell-dove/depends/tiff/.gitignore
new file mode 100644
index 0000000..48e2237
--- /dev/null
+++ b/tools/marvell-dove/depends/tiff/.gitignore
@@ -0,0 +1 @@
+tiff-3.8.2
diff --git a/tools/marvell-dove/depends/tiff/.installed b/tools/marvell-dove/depends/tiff/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/tiff/Makefile b/tools/marvell-dove/depends/tiff/Makefile
new file mode 100644
index 0000000..e6539c3
--- /dev/null
+++ b/tools/marvell-dove/depends/tiff/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=tiff
+VERSION=3.8.2
+SOURCE=$(LIBNAME)-$(VERSION)
+ARCHIVE=$(SOURCE).tar.gz
+
+# configuration settings
+CONFIGURE=./configure --prefix=$(PREFIX) --host=$(HOST)
+
+LIBDYLIB=$(SOURCE)/libtiff/.libs/lib$(LIBNAME).so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)/$(ARCHIVE)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); $(CONFIGURE)
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)
+
+.installed:
+	make -C $(SOURCE) install
+	touch $@
+
+clean:
+	make -C $(SOURCE) clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
diff --git a/tools/marvell-dove/depends/xbmc/Makefile b/tools/marvell-dove/depends/xbmc/Makefile
new file mode 100755
index 0000000..cd3175e
--- /dev/null
+++ b/tools/marvell-dove/depends/xbmc/Makefile
@@ -0,0 +1,31 @@
+include ../../Makefile.include
+include ../depends.mk
+
+SOURCE=../../../../
+
+ifeq ($(USE_BUILDROOT),1)
+	export PATH:=$(PREFIX)/bin:$(BUILDROOT)/output/host/usr/bin:$(SYSROOT)/usr/bin:$(PATH)
+endif
+
+CONFIGURE=./configure --prefix=$(PREFIX) --build=$(BUILD) --host=$(HOST) \
+					--enable-gles --disable-pulse --disable-projectm --enable-dbus \
+					--disable-optimizations --enable-debug --with-platform=marvell-dove
+
+#CONFIGURE=./configure --prefix=$(PREFIX) --build=$(BUILD) --host=$(HOST) \
+#	--enable-gles --enable-external-python --disable-sdl --disable-x11 --disable-xrandr \
+#	--disable-optical-drive --disable-dvdcss --disable-joystick --disable-debug \
+#	--disable-crystalhd --disable-vda --disable-vtbdecoder --disable-vaapi --disable-vdpau \
+#	--enable-platform-raspberry-pi --disable-openmax --disable-pulse --disable-projectm \
+#	--enable-dbus
+
+all: configure
+
+clean:
+distclean:
+	cd $(SOURCE);
+
+configure:
+	cd $(SOURCE); ./bootstrap
+	cd $(SOURCE); $(CONFIGURE)
+	#cd $(SOURCE); make -j $(JOBS)
+	#cd $(SOURCE); make install
diff --git a/tools/marvell-dove/depends/yajl/.gitignore b/tools/marvell-dove/depends/yajl/.gitignore
new file mode 100644
index 0000000..0a99d31
--- /dev/null
+++ b/tools/marvell-dove/depends/yajl/.gitignore
@@ -0,0 +1 @@
+lloyd-yajl-f4b2b1a
diff --git a/tools/marvell-dove/depends/yajl/.installed b/tools/marvell-dove/depends/yajl/.installed
new file mode 100644
index 0000000..e69de29
diff --git a/tools/marvell-dove/depends/yajl/Makefile b/tools/marvell-dove/depends/yajl/Makefile
new file mode 100644
index 0000000..22386ad
--- /dev/null
+++ b/tools/marvell-dove/depends/yajl/Makefile
@@ -0,0 +1,41 @@
+include ../../Makefile.include
+include ../depends.mk
+
+# lib name, version
+LIBNAME=yajl
+VERSION=2.0.1
+SOURCE=lloyd-$(LIBNAME)-f4b2b1a
+ARCHIVE=$(LIBNAME)-$(VERSION).tar.gz
+BASE_URL=http://github.com/lloyd/yajl/tarball/2.0.1
+CMAKE=cmake
+# configuration settings
+LIBDYLIB=$(SOURCE)/build/$(LIBNAME)-$(VERSION)/lib/libyajl.so
+
+CLEAN_FILES=$(ARCHIVE) $(SOURCE)
+
+all: $(LIBDYLIB) .installed
+
+$(TARBALLS_LOCATION)/$(ARCHIVE):
+	$(RETRIEVE_TOOL) $(RETRIEVE_TOOL_FLAGS) $(BASE_URL)
+
+$(SOURCE): $(TARBALLS_LOCATION)/$(ARCHIVE)
+	rm -rf $(SOURCE)
+	$(ARCHIVE_TOOL) $(ARCHIVE_TOOL_FLAGS) $(TARBALLS_LOCATION)/$(ARCHIVE)
+	echo $(SOURCE) > .gitignore
+	cd $(SOURCE); mkdir build; cd build; $(CMAKE) -DCMAKE_INSTALL_PREFIX='$(PREFIX)' ../
+
+$(LIBDYLIB): $(SOURCE)
+	make -j $(JOBS) -C $(SOURCE)/build
+
+.installed:
+	make -C $(SOURCE)/build install
+	touch $@
+
+clean:
+	make -C $(SOURCE)/build clean
+	rm -f .installed
+
+distclean::
+	rm -rf $(SOURCE) .installed
+
+
diff --git a/tools/marvell-dove/setup-sdk.sh b/tools/marvell-dove/setup-sdk.sh
new file mode 100755
index 0000000..ebcf70e
--- /dev/null
+++ b/tools/marvell-dove/setup-sdk.sh
@@ -0,0 +1,41 @@
+#!/bin/bash
+
+SCRIPT_PATH=$(cd `dirname $0` && pwd)
+
+USE_BUILDROOT=1
+
+if [ "$USE_BUILDROOT" = "1" ]; then
+  BUILDROOT=/opt/xbmc-cubox/buildroot
+  TARBALLS=/opt/xbmc-tarballs
+  XBMCPREFIX=/opt/xbmc-cubox/xbmc-bin
+
+  SDKSTAGE=$BUILDROOT/output/staging
+  TARGETFS=$BUILDROOT/output/target
+  TOOLCHAIN=$BUILDROOT/output/host/usr/
+else
+  TARBALLS=/opt/xbmc-tarballs
+  SDKSTAGE=/opt/cubox-rootfs
+  XBMCPREFIX=/opt/xbmc-cubox/xbmc-bin
+  TARGETFS=/opt/cubox-rootfs
+  TOOLCHAIN=/usr/local/cubox-gcc
+  BUILDROOT=/opt/cubox-rootfs
+fi
+
+sudo mkdir -p $XBMCPREFIX
+sudo chmod 777 $XBMCPREFIX
+mkdir -p $XBMCPREFIX/lib
+mkdir -p $XBMCPREFIX/include
+
+echo "SDKSTAGE=$SDKSTAGE"                                              >  $SCRIPT_PATH/Makefile.include
+echo "XBMCPREFIX=$XBMCPREFIX"                                          >> $SCRIPT_PATH/Makefile.include
+echo "TARGETFS=$TARGETFS"                                              >> $SCRIPT_PATH/Makefile.include
+echo "TOOLCHAIN=$TOOLCHAIN"                                            >> $SCRIPT_PATH/Makefile.include
+echo "BUILDROOT=$BUILDROOT"                                            >> $SCRIPT_PATH/Makefile.include
+echo "USE_BUILDROOT=$USE_BUILDROOT"                                    >> $SCRIPT_PATH/Makefile.include
+echo "BASE_URL=http://mirrors.xbmc.org/build-deps/darwin-libs"         >> $SCRIPT_PATH/Makefile.include
+echo "TARBALLS_LOCATION=$TARBALLS"                                     >> $SCRIPT_PATH/Makefile.include
+echo "RETRIEVE_TOOL=/usr/bin/curl"                                     >> $SCRIPT_PATH/Makefile.include
+echo "RETRIEVE_TOOL_FLAGS=-Ls --create-dirs --output \$(TARBALLS_LOCATION)/\$(ARCHIVE)" >> $SCRIPT_PATH/Makefile.include
+echo "ARCHIVE_TOOL=/bin/tar"                                           >> $SCRIPT_PATH/Makefile.include
+echo "ARCHIVE_TOOL_FLAGS=xf"                                           >> $SCRIPT_PATH/Makefile.include
+echo "JOBS=$((`grep -c processor /proc/cpuinfo` -1))"                  >> $SCRIPT_PATH/Makefile.include
-- 
1.7.4.1

