#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build sqlite

HOST_PYTHON="`ls -d $ROOT/$BUILD/Python*/objdir/buildpython`/python"
PYTHON_DIR=`ls -d $ROOT/$BUILD/Python*`

export CFLAGS="$CFLAGS -I$PYTHON_DIR/Include -I$PYTHON_DIR/objdir"
export LDSHARED="$CC -shared"

cd $BUILD/$1*
sed -i -e "s%^include_dirs=.*%include_dirs=$LIB_PREFIX/include%" setup.cfg
sed -i -e "s%^library_dirs=.*%library_dirs=$LIB_PREFIX/lib%" setup.cfg
$HOST_PYTHON setup.py build
