#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build sqlite

HOST_PYTHON="`ls -d $ROOT/$BUILD/Python*/objdir/buildpython`/python"
PYTHON_DIR=`ls -d $ROOT/$BUILD/Python*`

export CFLAGS="$CFLAGS -I$PYTHON_DIR/Include -I$PYTHON_DIR/objdir"
export LDSHARED="$CC -shared"

cd $BUILD/$1*
$HOST_PYTHON setup.py build

rm -rf build/lib*/pysqlite2/test/*.py
$HOST_PYTHON -Wi -t $PYTHON_DIR/Lib/compileall.py build/lib*/pysqlite2
