#!/bin/sh

. config/options

require_glibc $1

NV_ARCH=x86
[ "$TARGET_ARCH" = x86_64 ] && NV_ARCH=x86_64

sh $SOURCES/$1/NVIDIA-Linux-${NV_ARCH}-*.run --extract-only --target $BUILD/$1

for i in $PACKAGES/$1/patches.nvidia/*.diff*; do
  echo "## Applying patch: $i"
  cat $i | patch -d `echo $BUILD/$1* | cut -f1 -d\ ` -p1 >&$VERBOSE_OUT
done
