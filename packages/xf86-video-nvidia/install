#!/bin/sh

. config/options

[ "$TARGET_LIBC" != glibc ] && echo "$1 requires glibc" && exit 1

XORG_DST="$INSTALLX/$XORG_PATH_MODULES"

# nVidia kernel driver
mkdir -p "`ls -d $INSTALL/lib/modules/*`/kernel/drivers/video"
cp $BUILD/$1/usr/src/nv/nvidia.ko $INSTALL/lib/modules/*/kernel/drivers/video

# X.Org driver
mkdir -p $XORG_DST/drivers
cp $BUILD/$1/usr/X11R6/lib/modules/drivers/*_drv.so $XORG_DST/drivers

# System Libs
cp $BUILD/$1/usr/lib/tls/*tls*.so* $INSTALLX/usr/lib/libnvidia-tls.so.1
cp $BUILD/$1/usr/X11R6/lib/modules/libnvidia-wfb.so* $XORG_DST/libwfb.so
