#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build freetype
$SCRIPTS/build zlib
$SCRIPTS/build libxml2

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=/usr \
            --sysconfdir=/etc \
            --with-arch=$TARGET_ARCH \
            --with-freetype-config=$LIB_PREFIX/bin/freetype-config \
            --enable-shared \
            --disable-static \
            --with-default-fonts=/usr/share/fonts \
            --without-add-fonts \
            --disable-dependency-tracking \
            --disable-docs

for m in fc-case fc-glyphname fc-lang fc-arch; do
  sed -i "s|LDFLAGS =.*|LDFLAGS =|" $m/Makefile
  sed -i "s|CFLAGS =.*|CFLAGS =${HOST_CFLAGS}|" $m/Makefile
done

make
make_install
