#!/bin/sh

. config/options

mkdir -p $BUILD/$1
$SCRIPTS/extract $1 "*" $BUILD/$1

# Rename firmwares that need to be
mv $BUILD/$1/p54pci_1.0.4.3.arm.bz2 $BUILD/$1/isl3890.bz2
mv $BUILD/$1/p54u_2.5.6.0.arm.bz2 $BUILD/$1/isl3890usb.bz2
mv $BUILD/$1/p54pci_1.1.0.0.arm.bz2 $BUILD/$1/isl3877.bz2
mv $BUILD/$1/p54u_3887_2.5.8.0.arm.bz2 $BUILD/$1/isl3887usb_bare.bz2

# Move firmwares to their belonging path
mkdir -p $BUILD/$1/acx/default
mv $BUILD/$1/tiacx* $BUILD/$1/acx/default/

# Extract firmware archives that need to be
[ -f $BUILD/$1/b43.tar ] && tar xvf $BUILD/$1/b43.tar
[ -f $BUILD/$1/b43legacy.tar ] && tar xvf $BUILD/$1/b43legacy.tar

# Uncompress firmwares
bunzip2 -f $BUILD/$1/*.bz2
bunzip2 -f $BUILD/$1/b43/*.bz2
bunzip2 -f $BUILD/$1/b43legacy/*.bz2
