#!/bin/sh

. config/options

require_glibc $1

mkdir -p $BUILD/$1
cd $BUILD/$1

for loc in $INCLUDED_LOCALES; do
  LOCALE=`echo $loc|cut -f1 -d.`
  CHARSET=`echo $loc|cut -f2 -d.`
  gzip -cd $SYSROOT_PREFIX/usr/share/i18n/charmaps/$CHARSET.gz > $CHARSET
  cp $SYSROOT_PREFIX/usr/share/locale/locale.alias .
  echo "Building $LOCALE.$CHARSET..."
  mkdir -p usr/lib/locale
  $SYSROOT_PREFIX/usr/bin/localedef -c \
  	-f $CHARSET \
	-i $SYSROOT_PREFIX/usr/share/i18n/locales/$LOCALE \
	-A locale.alias \
	--prefix $ROOT/$BUILD/$1 \
	$LOCALE
done
