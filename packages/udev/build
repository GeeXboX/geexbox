#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build GLib
$SCRIPTS/build libusb
$SCRIPTS/build usbutils

export ac_cv_file__usr_share_pci_ids="no"
export ac_cv_file__usr_share_hwdata_pci_ids="no"
export ac_cv_file__usr_share_misc_pci_ids="yes"

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --enable-silent-rules \
            --enable-extras \
            --disable-introspection \
            --prefix=/usr \
            --sysconfdir=/etc \
            --sbindir=/sbin \
            --libdir=/usr/lib \
            --with-rootlibdir=/lib \
            --libexecdir=/lib/udev \
            --mandir=/usr/share/man \
            --infodir=/usr/share/info \
            --without-selinux \
            --disable-static \
            --enable-shared \
            --disable-gtk-doc \

make
make install-pkgconfigDATA \
  libdir=$LIB_PREFIX/lib
cp -P libudev/libudev.h $LIB_PREFIX/include/
cp -P libudev/libudev.la $LIB_PREFIX/lib/
cp -P libudev/.libs/libudev.so* $LIB_PREFIX/lib/
mkdir -p $LIB_PREFIX/include/gudev
for i in gudev gudevenums gudevenumtypes gudevtypes gudevclient gudevdevice; do
  cp -P extras/gudev/$i.h $LIB_PREFIX/include/gudev
done
cp -P extras/gudev/libgudev*.la $LIB_PREFIX/lib/
cp -P extras/gudev/.libs/libgudev*.so* $LIB_PREFIX/lib/
