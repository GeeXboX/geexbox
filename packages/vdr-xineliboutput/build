#!/bin/sh

. config/options

$SCRIPTS/build vdr

VDR_DIR=`basename $BUILD/vdr-1*`

cd $BUILD/$1*

if pkg_uses $1 fb || pkg_uses $1 directfb; then
  FB_CONFIG="--enable-fb"
else
  FB_CONFIG="--disable-fb"
fi

if pkg_uses $1 vdpau; then
  VDPAU_CONFIG="--enable-vdpau"
else
  VDPAU_CONFIG="--disable-vdpau"
fi

if pkg_uses $1 xorg; then
  XORG_CONFIG="--enable-x11 --disable-xinerama"
else
  XORG_CONFIG="--disable-x11--disable-xinerama"
fi

./configure \
           $FB_CONFIG \
           $XORG_CONFIG \
           --enable-vdr \
           --enable-libxine \
           --enable-libjpeg \

sed -i 's:XINEPLUGINDIR=.*:XINEPLUGINDIR=/usr/lib/xine/plugins/2.0:' config.mak

export VDRDIR="$ROOT/$BUILD/$VDR_DIR"

make \
  LIBDIR="." \
  LOCALEDIR="./locale" \
  OPTFLAGS="-I$LIB_PREFIX/include -L$LIB_PREFIX/lib -lxine" \

make_install
