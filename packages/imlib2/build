#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build libpng
$SCRIPTS/build jpeg
$SCRIPTS/build libungif
$SCRIPTS/build tiff
$SCRIPTS/build zlib
$SCRIPTS/build freetype

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=$LIB_PREFIX \
            --with-freetype-config=$LIB_PREFIX/bin/freetype-config \
            --enable-shared \
            --disable-static \
            --disable-amd64 \
            --with-jpeg \
            --with-png \
            --with-tiff \
            --with-gif \
            --with-zlib \
            --without-bzip2 \
            --without-id3 \
            --with-x \
            --x-includes="" \
            --x-libraries=""

sed -i 's%#define PACKAGE_LIB_DIR.*%#define PACKAGE_LIB_DIR "/usr/lib"%' config.h

make
make install

cp imlib2-config $ROOT/$TOOLCHAIN/bin
sed -i "s%-L/usr/X11R6/lib%%" $ROOT/$TOOLCHAIN/bin/imlib2-config
sed -i "s%--rpath $LIB_PREFIX/lib%%" $ROOT/$TOOLCHAIN/bin/imlib2-config
