#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build gettext
$SCRIPTS/build GLib
$SCRIPTS/build expat
$SCRIPTS/build dbus

export ac_cv_have_abstract_sockets=yes
export ac_cv_func_posix_getpwnam_r=yes
export have_abstract_sockets=yes

export CFLAGS="$CFLAGS -I$LIB_PREFIX/include"
export LDFLAGS="$LDFLAGS -L$LIB_PREFIX/lib"

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=$LIB_PREFIX \
            --sysconfdir=/etc \
            --disable-static \
            --enable-shared \
            --disable-tests \
            --disable-gtk-doc \
            --disable-doxygen-docs \
            --enable-asserts=no \

make -C dbus SUBDIRS="."
strip_libs dbus/.libs
make -C dbus install-libdbus_glibHEADERS
make -C dbus install-libLTLIBRARIES
make install-pkgconfigDATA
