#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build openssl
$SCRIPTS/build curl
$SCRIPTS/build eina
$SCRIPTS/build eet
$SCRIPTS/build evas

if [ "$XORG" = yes ]; then
  $SCRIPTS/build xorg-libs
  WITH_X="--with-x --enable-ecore-evas-software-16-x11"
fi

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=$LIB_PREFIX \
            --disable-static \
            --enable-shared \
            --enable-ecore-fb \
            --disable-ecore-x-xcb \
            --disable-ecore-evas-opengl-x11 \
            --disable-ecore-evas-software-xcb \
            --disable-ecore-evas-xrender-xcb \
            --enable-ecore-evas \
            $WITH_X \

make
ECORE_LIBS="ecore ecore_evas ecore_config ecore_job ecore_ipc ecore_imf ecore_imf_evas ecore_file ecore_con ecore_txt"
[ "$XORG" = yes ] && ECORE_LIBS="$ECORE_LIBS ecore_x"
for i in $ECORE_LIBS; do
  $STRIP src/lib/$i/.libs/*.so*
done
make install
