#!/bin/sh
#
# bluetooth_serial
#
# Bluetooth serial PCMCIA card initialization
#

start_serial()
{
  [ -x /usr/bin/setserial -a -x /usr/bin/hciattach ] || return 1
  [ -n "$BAUDBASE" ] && /usr/bin/setserial $DEVNAME baud_base $BAUDBASE
  /usr/bin/hciattach $DEVNAME $HCIOPTS 2>&1
}

stop_serial()
{
  [ -x /usr/bin/fuser ] || return 1 
  /usr/bin/fuser -k -HUP $DEVNAME > /dev/null 2>&1
}

case "$ACTION" in
  add)
    start_serial
    ;;
  remove)
    stop_serial
    ;;
  *)
    ;;
esac
