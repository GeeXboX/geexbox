#!/bin/sh

. config/options

$SCRIPTS/build gstreamer
$SCRIPTS/build ffmpeg
$SCRIPTS/build alsa-lib
$SCRIPTS/build alsa-lib
$SCRIPTS/build liboil

if [ "$DEBUG" = yes ]; then
  DEBUG_CONFIG="--enable-debug"
else
  DEBUG_CONFIG="--disable-debug --disable-profiling --disable-gcov"
fi

if [ "$XORG" = yes ]; then
  XORG_CONFIG="--with-x --enable-x --enable-xvideo --enable-xshm"
else
  XORG_CONFIG="--without-x --disable-x --disable-xvideo --disable-xshm"
fi

export LIBS="-L$SYSROOT_PREFIX/usr/lib"

cd $BUILD/$1*
export PATH="$PATH:$LIB_PREFIX/bin"
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=$LIB_PREFIX \
            --enable-shared \
            --disable-static \
            --enable-largefile \
            --disable-nls \
            --disable-rpath \
            $DEBUG_CONFIG \
            --disable-gtk-doc \
            --disable-adder \
            --disable-app \
            --enable-audioconvert \
            --enable-audiorate \
            --enable-audiotestsrc \
            --enable-ffmpegcolorspace \
            --disable-gdp \
            --enable-playback \
            --enable-audioresample \
            --enable-subparse \
            --enable-tcp \
            --enable-typefind \
            --enable-videotestsrc \
            --enable-videorate \
            --enable-videoscale \
            --enable-volume \
            $XORG_CONFIG \
            --disable-gst_v4l \
            --enable-alsa \
            --disable-cdparanoia \
            --disable-gnome_vfs \
            --disable-ivorbis \
            --disable-gio \
            --disable-libvisual \
            --disable-ogg \
            --disable-oggtest \
            --disable-pango \
            --disable-theora \
            --disable-vorbis \
            --disable-vorbistest \
            --disable-freetypetest \

make
strip_libs gst
strip_libs gst-libs
make install
