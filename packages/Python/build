#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build readline
$SCRIPTS/build termcap

export OPT="$CFLAGS"
export HOST_CC HOST_CXX HOST_RANLIB HOST_AR HOST_CFLAGS HOST_CXXFLAGS
export SYSROOT_PREFIX

cd $BUILD/$1*
mkdir -p objdir
cd objdir
../configure --host=$TARGET_NAME \
             --build=$HOST_NAME \
             --prefix=/usr \
             --enable-static \
             --disable-shared \
             --with-threads \
             --disable-ipv6 \
             --disable-profiling \
             --without-pydebug \
             --without-doc-strings \
             --without-tsc \
             --without-pymalloc \
             --without-fpectl \
             --without-wctype-functions \
             --without-cxx
make

# Compile all Python modules
rm -rf ../Lib/test
buildpython/python -Wi -t ../Lib/compileall.py ../Lib
