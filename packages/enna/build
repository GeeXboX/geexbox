#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build freetype
$SCRIPTS/build evas
$SCRIPTS/build ecore
$SCRIPTS/build embryo
$SCRIPTS/build edje
$SCRIPTS/build e_dbus
$SCRIPTS/build elementary
$SCRIPTS/build curl
$SCRIPTS/build libxml2
$SCRIPTS/build libplayer
$SCRIPTS/build libvalhalla
$SCRIPTS/build lirc

if [ "$GAMES" = yes ]; then
  $SCRIPTS/build efreet
  GAMES_OPT="--enable-activity-games --enable-efreet"
else
  GAMES_OPT="--disable-activity-games --disable-efreet"
fi

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=$LIB_PREFIX \
            --exec-prefix=/usr \
            --sysconfdir=/etc \
            --datadir=/usr/share \
            --disable-static \
            --enable-shared \
            --disable-theme \
            --enable-activity-music \
            --enable-activity-photo \
            --enable-activity-video \
            --enable-activity-weather \
            --disable-backend-emotion \
            --enable-backend-libplayer \
            --enable-browser-dvd \
            --disable-browser-lms \
            --enable-browser-localfiles \
            --enable-browser-netstreams \
            --disable-browser-shoutcast \
            --disable-browser-upnp \
            --enable-browser-valhalla \
            --enable-metadata-amazon \
            --enable-metadata-libplayer \
            --enable-metadata-localfiles \
            --enable-metadata-tmdb \
            --enable-metadata-tvdb \
            --enable-volume-hal \
            --enable-volume-mtab \
            --disable-libcddb \
            --enable-libcurl \
            --disable-libexif \
            --enable-libxml2 \
            $GAMES_OPT \

make

[ "$GAMES" = yes ] && $STRIP src/modules/activity/music/.libs/activity_games.so
$STRIP src/modules/activity/music/.libs/activity_music.so
$STRIP src/modules/activity/photo/.libs/activity_photo.so
$STRIP src/modules/activity/video/.libs/activity_video.so
$STRIP src/modules/activity/weather/.libs/activity_weather.so
$STRIP src/modules/browser/dvd/.libs/browser_dvd.so
$STRIP src/modules/backend/libplayer/.libs/backend_libplayer.so
$STRIP src/modules/browser/localfiles/.libs/browser_localfiles.so
$STRIP src/modules/browser/netstreams/.libs/browser_netstreams.so
$STRIP src/modules/browser/valhalla/.libs/browser_valhalla.so
$STRIP src/modules/metadata/amazon/.libs/metadata_amazon.so
$STRIP src/modules/metadata/tmdb/.libs/metadata_tmdb.so
$STRIP src/modules/metadata/tvdb/.libs/metadata_tvdb.so
$STRIP src/modules/metadata/localfiles/.libs/metadata_localfiles.so
$STRIP src/modules/metadata/libplayer/.libs/metadata_libplayer.so
$STRIP src/modules/volume/hal/.libs/volume_hal.so
$STRIP src/modules/volume/mtab/.libs/volume_mtab.so
