#!/bin/sh

. config/options

export gt_cv_func_gnugettext1_libintl=no

TLS_CONFIG="--enable-tls"
[ $TARGET_LIBC = "uClibc" ] && TLS_CONFIG="--disable-tls"

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --target=$TARGET_NAME \
            --prefix=/usr \
            --enable-static \
            --disable-shared \
            --without-ncurses \
            $TLS_CONFIG

make -C fdisk sfdisk
make -C misc-utils blkid
make -C shlibs/blkid
make -C shlibs/uuid
make -C mount mount
make -C mount umount

instroot="$PWD/.install"
make -C shlibs/blkid install DESTDIR="$instroot"
make -C shlibs/uuid install DESTDIR="$instroot"
fix_libs $instroot
