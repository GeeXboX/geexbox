#!/bin/sh
#
# configure MPlayer's menu
#
# runlevels: geexbox, debug, configure

echo "### Configuring MPlayer's menu ###"

# remove CD from menu if no cd drive is available
test -e /dev/cdrom || sed -i 's/.*loadfile vcd.*//' /etc/mplayer/menu.conf
test -e /dev/cdrom || sed -i 's/.*loadfile cdda.*//' /etc/mplayer/menu.conf

# remove DVD from the menu if no dvd drive is available
test -e /dev/dvd || sed -i 's/.*play_dvd.*//' /etc/mplayer/menu.conf

if [ -e /var/use_xorg ]; then
  test -x /usr/bin/feh  || ( echo -n "" > /etc/img_ext; sed -i 's/.*set_menu view_img_timeout.*//' /etc/mplayer/menu.conf )
else
  test -x /usr/bin/fbi -a -e /dev/fb0 || ( echo -n "" > /etc/img_ext; sed -i 's/.*set_menu view_img_timeout.*//' /etc/mplayer/menu.conf )
fi

# build a single file extensions filter
cat /etc/file_ext > /etc/extensions
cat /etc/list_ext >> /etc/extensions
cat /etc/img_ext >> /etc/extensions

exit 0
