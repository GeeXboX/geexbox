#!/bin/sh
#
# configure MPlayer's menu
#
# runlevels: geexbox, debug, configure

echo "### Configuring MPlayer's menu ###"

if [ -e /var/use_xorg ]; then
  test -x /usr/bin/feh  || ( echo -n "" > /etc/img_ext; sed -i 's/.*set_menu view_img_timeout.*//' /etc/mplayer/menu.conf )
else
  test -x /usr/bin/fbi -a -e /dev/fb0 || ( echo -n "" > /etc/img_ext; sed -i 's/.*set_menu view_img_timeout.*//' /etc/mplayer/menu.conf )
fi

# build a single file extensions filter
cat /etc/file_ext > /etc/extensions
cat /etc/list_ext >> /etc/extensions
cat /etc/img_ext >> /etc/extensions

# use fuseiso if it exists
if [ -x /usr/bin/fuseiso ]; then
  modprobe fuse
  echo > /var/mount_cdvdimg
else
  sed -i 's/.*set_menu cdvdimg_settings.*//' /etc/mplayer/menu.conf
fi

exit 0
