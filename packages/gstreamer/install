#!/bin/sh

GST_VERSION=0.10
GST_PLUGINS_PATH=$INSTALL/usr/lib/gstreamer-$GST_VERSION

gst_install () {
  PLUGIN_PATH="$1"
  PLUGIN_NAME="$2"

  cp -P $BUILD/gstreamer-*/$PLUGIN_PATH/$PLUGIN_NAME/.libs/libgst${PLUGIN_NAME}*.so* $INSTALL/usr/lib
}

. config/options

$SCRIPTS/install zlib
$SCRIPTS/install libxml2
$SCRIPTS/install GLib

mkdir -p $INSTALL/usr/lib
cp -PR $BUILD/gstreamer-*/gst/.libs/libgstreamer-0.10.so* $INSTALL/usr/lib
cp -PR $BUILD/gstreamer-*/plugins/elements/.libs/libgstcoreelements.so $INSTALL/usr/lib
cp -PR $BUILD/gstreamer-*/plugins/indexers/.libs/libgstcoreindexers.so $INSTALL/usr/lib

gst_install libs/gst base
gst_install libs/gst controller
gst_install libs/gst dataprotocol
gst_install libs/gst net

if [ "$DEVTOOLS" = yes ]; then
  mkdir -p $GST_PLUGINS_PATH/gstreamer-$GST_VERSION
  cp -PR $BUILD/gstreamer-*/libs/gst/helpers/.libs/gst-plugin-scanner $GST_PLUGINS_PATH/gstreamer-$GST_VERSION

  mkdir -p $INSTALL/usr/bin
  for i in feedback inspect launch typefind xmlinspect xmllaunch; do
    cp -PR $BUILD/gstreamer-*/tools/gst-$i $INSTALL/usr/bin
  done
fi

exit 0
