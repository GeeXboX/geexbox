#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build udev

export LIBUDEV_CFLAGS="-I`ls -d $ROOT/$BUILD/udev*`"
export LIBUDEV_LIBS="-I`ls -d $ROOT/$BUILD/udev*`"

export CFLAGS="$CFLAGS -march=$TARGET_FAMILY"

cd $BUILD/$1*
./configure --host=$TARGET_NAME \
            --build=$HOST_NAME \
            --prefix=$LIB_PREFIX \
            --enable-shared \
            --disable-static \
            --enable-udev \
            --enable-largefile
make -C shared-core
make -C libdrm
strip_libs libdrm
make install -C shared-core
make install -C libdrm
cp *.pc $LIB_PREFIX/lib/pkgconfig
