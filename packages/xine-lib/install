#!/bin/sh

. config/options

$SCRIPTS/install zlib
$SCRIPTS/install libiconv
$SCRIPTS/install ffmpeg
$SCRIPTS/install freetype
[ "$DEVTOOLS" = yes ] && $SCRIPTS/install xine-ui

mkdir -p $INSTALL/usr/lib
cp -PR $BUILD/$1*/src/xine-engine/.libs/libxine*.so* $INSTALL/usr/lib

mkdir -p $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/audio_dec/.libs/xineplug_decode_mad.so \
  $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/audio_out/.libs/xineplug_ao_out_alsa.so \
  $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/audio_out/.libs/xineplug_ao_out_none.so \
  $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/demuxers/.libs/xineplug_dmx_mpeg*.so \
  $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/input/.libs/xineplug_inp_dvd.so \
  $INSTALL/usr/lib/xine/plugins/2.0
[ "$DEVTOOLS" = yes ] && \
  cp $BUILD/$1*/src/input/.libs/xineplug_inp_file.so \
    $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/combined/ffmpeg/.libs/xineplug_decode_ff.so \
  $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/spu_dec/.libs/xineplug_*.so $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/video_dec/libmpeg2/.libs/xineplug_decode_mpeg2.so \
  $INSTALL/usr/lib/xine/plugins/2.0
[ "$VDPAU" = yes ] && \
  cp $BUILD/$1*/src/video_dec/libvdpau/.libs/xineplug_decode_vdpau_*.so \
    $INSTALL/usr/lib/xine/plugins/2.0
cp $BUILD/$1*/src/video_out/.libs/xineplug_vo_out_none.so \
  $INSTALL/usr/lib/xine/plugins/2.0
[ "$CONSOLE" = yes ] && \
  cp $BUILD/$1*/src/video_out/.libs/xineplug_vo_out_fb.so \
    $INSTALL/usr/lib/xine/plugins/2.0
[ "$XORG" = yes ] && \
  cp $BUILD/$1*/src/video_out/.libs/xineplug_vo_out_x*.so \
    $INSTALL/usr/lib/xine/plugins/2.0
[ "$XORG" = yes ] && \
  cp $BUILD/$1*/src/video_out/.libs/xineplug_vo_out_opengl.so \
    $INSTALL/usr/lib/xine/plugins/2.0
[ "$VDPAU" = yes ] && \
  cp $BUILD/$1*/src/video_out/.libs/xineplug_vo_out_vdpau.so \
    $INSTALL/usr/lib/xine/plugins/2.0
[ "$VDR" = yes ] && \
  cp $BUILD/$1*/src/vdr/.libs/xineplug_vdr.so $INSTALL/usr/lib/xine/plugins/2.0

mkdir -p $INSTALL/usr/lib/xine/plugins/2.0/post
cp $BUILD/$1*/src/post/audio/.libs/xineplug_post_audio_filters.so \
  $INSTALL/usr/lib/xine/plugins/2.0/post
cp $BUILD/$1*/src/post/deinterlace/.libs/xineplug_post_tvtime.so \
  $INSTALL/usr/lib/xine/plugins/2.0/post
cp $BUILD/$1*/src/post/planar/.libs/xineplug_post_planar.so \
  $INSTALL/usr/lib/xine/plugins/2.0/post

mkdir -p $INSTALL/etc/xine
cp $PACKAGES/$1/config/config $INSTALL/etc/xine
[ "$VDPAU" = yes ] && \
  echo "engine.buffers.video_num_frames: 22" >> $INSTALL/etc/xine/config

exit 0
