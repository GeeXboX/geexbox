#!/bin/sh

. config/options

$SCRIPTS/build toolchain
$SCRIPTS/build a52dec
$SCRIPTS/build zlib

if [ "$DEBUG" = yes ]; then
  DEBUG_CONFIG="--enable-debug"
else
  DEBUG_CONFIG="--disable-debug"
fi
if [ "$LIBSTRIP" = yes ]; then
  LIBSTRIP_CONFIG="--enable-stripping"
else
  LIBSTRIP_CONFIG="--disable-stripping"
fi

cd $BUILD/$1*
./configure --enable-cross-compile \
            --cross-prefix=$TARGET_PREFIX \
	    --arch=$TARGET_NAME \
            --prefix=$LIB_PREFIX \
	    --extra-cflags="$CFLAGS" \
	    --cpu=$TARGET_CPU \
            --disable-static \
            --enable-shared \
	    --disable-ffmpeg \
	    --disable-ffserver \
	    --enable-gpl \
	    --disable-ipv6 \
	    --enable-pthreads \
	    --enable-small \
	    --enable-zlib \
	    --disable-vhook \
	    --enable-postproc \
	    --enable-swscale \
	    --enable-liba52 \
	    $DEBUG_CONFIG \
	    $LIBSTRIP_CONFIG
make
make install
