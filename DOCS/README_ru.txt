         ooooo                     oo     o  o               oo     o
        M"   "Mo                    Mo  oM"  M                Mo  oM"
       M           oM""Mo  oM""Mo    "Mo"    Mo"""o  oM""Mo    "Mo"
       M    """M   MooooMM MooooMM   oMMo    M    "M M    M    oMMo
       "o     oM   M    o  M    o   oM  Mo   M    oM M    M   oM  Mo
        "MoooM"M   "MooM"  "MooM"  M"    "M  M"ooo"  "MooM"  M"    "M



О GeeXboX.

GeeXboX - своего рода "divx коробка". Фактически, это независимый загрузочный CD, который позволяет смотреть фильмы и слушать музыку.
GeeXboX поддерживает много форматов, например, такие как: avi, mpeg, divx, ogm, rm, mp3, ogg, dvd, vcd и cdda. 
GeeXboX также поддерживает некоторые ir-пульты дистанционного управления и tv-out для некоторых графических карт.
Этот архив содержит необходимые сценарии для сборки iso образа GeeXboX.



Требования.

Для генерации iso образа GeeXboX необходимо одно из следующего:
   - GNU/Linux система с mkisofs и mkzftree
   - MAC OS X система с mkisofs и mkzftree
   - windows система

Для установки GeeXboX, Вам потребуется:
   - GNU/Linux система с syslinux

Для сборки GeeXboX, Вам будут необходимы некоторые классические инструменты:
   - работающая GNU/Linux система
   - gcc C компилятор
   - GNU make
   - patch
   - nasm assembler
   - bzip2 и gzip
   - mkfs.ext2 и mkfs.vfat
   - wget загрузчик (не требуется для полного набора GeeXboX)
   - mkisofs и mkzftree для сборки iso образа
   - mkzftree для сжатия файлов iso образа
   - cdrecord (для прожига iso образа)

Так же необходимы 1.2 Гб свободного места на жестком диске.



Персонализация

Когда GeeXboX установлен на жесткий диск или сгенерирован, его довольно легко персонализировать.

Вы можете добавить некоторые проприетарные кодеки, такие как rv9 или wmv9, просто, поместив их в директорию GEEXBOX/codecs.
Вы можете найти эти кодеки в пакете на http://www.geexbox.org/releases/geexbox-extra-codecs-nonfree.tar.gz

Также Вы можете изменить много опций. Для этого просто отредактируйте некоторые текстовые файлы.

Язык - можно легко выбрать предпочитаемый Вами язык меню, следуя приведенной ниже процедуре:
   - GNU/Linux пользователи:
   Отредактируйте скрипт generator.sh перед его выполнением и измените строку в начале:    "MENU_LANG=en" на предпочитаемый Вами язык. Например, если Вы француз, измените это так "MENU_LANG=fr".

   - Microsoft Windows пользователи:
   После запуска generator.exe предоставляет комбинированный список, который позволяет выбрать, предпочитаемый Вами язык.
   Замечание: это не влияет на язык DVD (смотрите раздел MPlayer).

   Пожалуйста, просмотрите директорию "language", в ней список доступных языков. 
   Если Ваш язык не доступен, Вы можете перевести меню на Ваш язык.
   Выполнить это просто,  создав language/menu_LANG.conf и language/help_LANG.txt, и добавив LANG в language/lang.conf.

MPlayer:
   Здесь Вы можете установить большинство параметров конфигурации и выполнить настройки.
   Опции задаются в файле packages/MPlayer/mplayer.conf.
   Можно модифицировать такие опции, как, например, размер OSD шрифта (subfont-text-scale).
   Так же можно добавить много опций, таких, как предопределенный язык DVD (например, alang=fr,en).
   Лучшее место, где можно найти описание - это руководство MPlayer для пользователей Linux (man -l build/MPlayer-*/DOCS/mplayer.1).
   Вы так же должны ознакомиться с документацией MPlayer (в build/MPlayer-*/DOCS или на http://mplayerhq.hu/DOCS/).
   Другой файл, который Вы можете модифицировать - это packages/MPlayer/menu.conf.
   Можно убрать части не нужные Вам, или например, перевести, нужные части на Ваш язык.
   Затем, последний файл, на который следует обратить внимание это packages/MPlayer/build.
   Он содержит набор опций, которые будут встроены в MPlayer.

tv-out:
   Включение tv-out достигается с помощью набора маленьких программ, предназначенных для различных видеокарт разных брэндов.
   В настоящее время, мы используем atitvout для ATI карт, s3switch для S3 карт и nvtv для nVidia карт
   (и, возможно, intel i810 и 3dfx). Эти программы конфигурируются в config/tvout.
   Здесь Вы можете выбрать, желаемый tv стандарт (pal, ntsc...), а так же модифицировать специальные опции для nvtv.
   
   # TV Output Standard (ntsc/pal/secam)
   TVOUT_STANDARD=pal

   Пожалуйста, заметьте, что Вы так же можете определить выходное соотношение (скажем 4:3 или 16:9 экран) в этом файле, редактируя строку:
 
   TVOUT_ASPECT="4:3"

   Этот параметр будет использоваться и для tv-out и для обычного (CRT/TFT) дисплеев.
   Вы можете так же определить желаемые значения высоты/ширины Вашего дисплея и горизонтальные и вертикальные частоты для таких случаев,
   как широкий экран или видеопроектор. Это может быть выполнено, редактированием /etc/mplayer/mplayer.conf файла.
   Параметры по-умолчанию показаны ниже (пожалуйста, раскомментируйте строки, относящиеся к частоте, если Вы хотите использовать их):

   screenw=800
   screenh=600
   #monitor-hfreq=31.5k-50k
   #monitor-vfreq=50-90

Lirc :
   Вы можете выбрать один из поддерживаемых пультов дистанционного управления, редактируя файл GEEXBOX/etc/remote.
   Так же позаботьтесь о выборе соответствующего ir приемника в том же конфигурационном файле.
   Если Вы хотите изменить привязку клавиш Вашего пульта дистанционного управления, посмотрите в файле GEEXBOX/etc/lirc/lircrc_REMOTE.

Сеть:
   Вы можете сконфигурировать сеть в файле GEEXBOX/etc/network.
   Здесь Вы можете выбрать ip адрес, используемый GeeXboX (изначально используется DHCP и если это не срабатывает,
   возвращаемся к 192.168.0.54).
   Вы можете также определить логин и пароль, которые будут использоваться для соединения с доступными ресурсами windows
   (изначально будет только соединение с анонимно доступными ресурсами).
   Вы можете так же объявить монтирование некоторых NFS в GEEXBOX/etc/nfs.

wifi:
   Изначально, GeeXboX пытается автоматически определить Ваши сетевые установки.
   Если Вы имеете обе традиционные NIC и WiFi карты только последняя будет задействована.
   Вы можете изменить /etc/network файл для задания Ваших сетевых установок. В нем 4 строки относятся к беспроводным картам :
   - PHY_TYPE="auto"      # физический тип сети (auto|ethernet|wifi)
   - WIFI_MODE="managed"  # wifi рабочий режим (managed|ad-hoc)
   - WIFI_WEP=""          # wifi WEP ключ
   - WIFI_ESSID="any"     # wifi SSID

   Эти строчки позволяют Вам сконфигурировать большинство установок.
   Вы можете разрешить включение автоопределения или явно указать использование ethernet или wifi адаптеров.
   Тем же путем можно выбрать между управляемым и ad-hoc режимом и определить Ваш WEP ключ и SSID.

gateway:
    GeeXboX поддерживает доступ к Internet. В случае, когда у Вас есть соединение с Internet,
    Вы можете сделать его доступным с помощью Вашего мультимедиа набора, используя router или gateway.
    Для этого, просто задайте gateway ip адрес в файле /etc/network.

   - GATEWAY=""     # Gateway ip ("" для DHCP или отсутствующего internet соединения)

tv конфигурация:
   GeeXboX поддерживает tv ввод и приемники. Система усердно старается автоматически определить карту и приемник.
   Вы можете задать установки и отменить попытку автоопределения. Пожалуйста, измените /etc/tvcard, как показано:

   #TV CARD/TUNER Model (AUTO для автоопределения или посмотрите по следующим интернет адресам)
   #http://www.linuxhq.com/kernel/v2.6/2/Documentation/video4linux/CARDLIST.bttv
   #http://www.linuxhq.com/kernel/v2.6/2/Documentation/video4linux/CARDLIST.tuner
 
   TV_CARD=AUTO
   TV_TUNER=AUTO
   TVIN_STANDARD=pal

   Пожалуйста, оставьте AUTO параметр, если желаете задействовать автоопределение, или замените его номером Вашей карты и типом приемника,
   в соответствии с предыдущими интернет адресами. Пожалуйста, будьте осторожны: в случае указания карты и типов приемников,
   Вы должны знать ТОЧНЫЕ ХАРАКТЕРИСТИКИ Вашего аппаратного обеспечения. Выполнив это, Вы должны быть способны использовать tv входы
   (Composite и S-VHS) на Вашей tv карте. Тем же путем, Вы можете использовать приемник для просмотра tv.
   Для этого, Вы должны будете задать регион принадлежности и частоту tv каналов, которые Вы хотите смотреть.
   Еще раз, просто отредактируйте файл /etc/tvcard:

   # tv каналы
   # синтакс: CHAN="частота канала:название канала"
   # пример:
   # CHAN="29:France 2"
   # CHAN="K08:Canal +"
   # список tv каналов 
   # доступные: france, europe-east, europe-west, us-bcast, us-cable
   CHANLIST=france

   Пожалуйста, будьте осторожны, когда редактируете каналы и просто используйте такой синтаксис, как указан выше,
   и tv каналы будут присутствовать в основном меню.

аудио конфигурация:
   GeeXboX поддерживает оба - аналоговый и цифровой аудио выходы через стандартные JACK соединители или через RCA SPDIF.
   Изначально, установлен аналоговый выход. Вы можете изменить это, редактируя файл /etc/audio:

   # Выход, использующий SPDIF (yes/no), иначе ANALOG выход
   SPDIF=no

   Помните, что Вам потребуется установка выхода в SPDIF, если Вы захотите соединить Вашу звуковую карту с каким-нибудь внешним усилителем
   для декодирования AC3/DTS потоков (используя сквозной режим).

видео обработка:
   Обработка это программный путь получения более гладкого и более точного представления Ваших видео записей.
   Это, тем не менее, задействует достаточно ресурсов CPU для изменения кадров но, как результат, они выглядят гораздо лучше.
   Используя внутренние фильтры MPlayer, GeeXboX позволяет выполнять h/v разблокирование, шумоподавление и автоподсветку
   для улучшения изображения. Изначально, обработка отключена для избежания запаздывания на слабых системах.
   Вы можете включить ее просто редактируя файл /etc/mplayer/mplayer.conf:

   # Установка обработки (h разблокирование, v разблокирование, шумоподавление, автоподсветка)
   # Поглощает CPU мощность, отключено для слабых систем, раскомментируйте для включения
   #vf=pp=hb:a/vb:a/dr:a/al:a

DXR3/Hollywood+ карты:
   Пользователям с аппаратным обеспечением подобного типа разжимающих карт даже НЕ нужно иметь видео и звуковую карту для использования
   GeeXboX. Так, только tvout коннектор может быть использован с DXR3 картами (нет CRT дисплея).
   Вы можете установить требуемую нормировку образа (PAL/NTSC) в файле /etc/tvout и качество выходного аудио,
   которое Вы хотите использовать (Аналоговый или SPDIF) в /etc/audio.



Генерация.

Во-первых, ознакомьтесь с персонализационной частью приведенной выше. Затем, в основном, Вы можете сгенерировать iso под Linux, выполнив
  ./generator.sh
или под windows, выполнив
  generator.exe



Дополнительные подзаголовочные шрифты.

Во-первых, убедитесь, что Ваш шрифт не включен в официальный GeeXboX пакет, используя генератор и
определяя Ваш шрифт в вышеуказанной секции. Большинство шрифтов уже включены в официальный пакет, некоторые поддерживаются,
но не включены по причине их чрезмерной величины (например, китайские шрифты).

Общая поддержка:
   Для добавления поддержки новых шрифтов Вы должны извлечь ваш шрифт в шрифт директорию и добавить название шрифта в
   language/lang.conf - переменная FONTS.

Поддержка китайского:
   Для включения китайских шрифтов в генерируемом geexbox iso Вы должны получить любой - big5 или gb2312 шрифт из распространяемых с
   MPlayer шрифтов:

   http://www1.mplayerhq.hu/MPlayer/contrib/fonts/chinesefonts/

   и распаковать, и скопировать в директорию генератора ./font/big5 или ./font/gb2312, которая оканчивается на `24` (размер шрифта 24).
   Например, если Вы желаете использовать 'gb2312 kai' шрифт:
   - GNU/Linux пользователи:
   wget http://www1.mplayerhq.hu/MPlayer/contrib/fonts/chinesefonts/gb2312-kai.tar.bz2
   tar -jxf gb2312-kai.tar.bz2
   mv gb2312-kai/gkai00mp24 ../path/to/generator/font/gb2312

   - Windows пользователи:
   Перепишите http://www1.mplayerhq.hu/MPlayer/contrib/fonts/chinesefonts/gb2312-kai.tar.bz2
   Откройте его с WinZip
   И извлеките gb2312-kai\gkai00mp24 директорию из архива в ..\path\to\generator\font\gb2312

Поддержка корейского:
   Аналогично поддержке китайского шрифта, только получить euc-kr шрифт Вы можете из:

   http://www1.mplayerhq.hu/MPlayer/contrib/fonts/korean/

   Хорошим выбором будет использование dotum20.tar.gz euc-kr шрифта и распаковка, и копирование в директорию генератора ./font/euc-kr
   путем, сходным с рассмотренным выше.



Установка.

Во-первых, Вам нужно создать FAT16/32 или EXT2/3 раздел с, по меньшей мере, 16 Мб свободного места.
Затем, Вы можете установить GeeXboX под Linux, выполнив
  ./installator.sh
Затем, ответьте на все вопросы. Будьте осторожны в течении этого шага. Прочтите дважды каждый вопрос и остановите установку,
если Вы не понимаете один из вопросов.
Но легчайшим путем установить GeeXboX, остается его загрузка с CD и ответ "install" на загрузочное сообщение isolinux.



PXE загрузка.

Да, GeeXboX может загружаться из сети на бездисковую станцию! Для достижения этого Вам потребуются:
   - DHCP сервер
   - TFTP сервер
   - NFS сервер
   - PXE совместимая станция :-)

Использование GNU/Linux системы:
Во-первых, сконфигурируйте Ваш dhcp сервер для передачи Вашей PXE загрузочной информации. Вот  пример с isc dhcp:

allow booting;
allow bootp;

subnet 192.168.0.0 netmask 255.255.255.0 {
  range 192.168.0.128 192.168.0.192;
  option subnet-mask 255.255.255.0;
  option broadcast-address 192.168.0.255;
  next-server 192.168.0.1;
  filename "/tftpboot/GEEXBOX/boot/pxelinux.0";
}

next-server опция это адрес TFTP сервера.
Затем сконфигурируйте Ваш TFTP сервер (так же, как atftpd), для сервера это /tftpboot директория,
и скопируйте полностью GEEXBOX дерево в эту директорию.
Например, Вы можете скопировать содержимое GeeXboX CD из linux С ВКЛЮЧЕНИЕМ ПРОЗРАЧНОЙ РАСПАКОВКИ CDROM!
(для проверки этого, посмотрите в файл sbin/init в GeeXboX дереве и проверьте, что там не содержится мусора)
Если Вы собираете GeeXboX самостоятельно из исходных текстов, Вы можете также сгенерировать GEEXBOX дерево с make pxe.
Затем Вы должны отредактировать файл /tftpboot/GEEXBOX/boot/pxelinux.cfg/default для установки nfsroot в
правильный NFS путь GEEXBOX дерева. Окончательно установите Ваш NFS для экспортирования GEEXBOX дерева с /etc/exports,
содержащим, что-то вроде этого:

/tftpboot/GEEXBOX (ro)

и /etc/hosts.allow содержащим, что-то вроде :

ALL: ALL

Такая вот премудрость. Загрузите Вашу PXE станцию и смотрите, что получилось.

Использование Microsoft Windows системы:

В случае загрузки в PXE режиме с Windows хоста, Вам потребуется следующее программное обеспечение:
   - TFTP и DHCP сервер (например, "tftpd32", доступный по http://tftpd32.jounin.net/)
   - NFS сервер (например, "Allegro NFS server", доступный по http://opensource.franz.com/nfs/)
   - компьютер, поддерживающий PXE загрузочный режим 

Перепишите и разожмите (инсталляция не требуется) tftpd32 папку куда-нибудь на Ваш диск.
В этом примере, давайте примем, что это: C:\tftpd32. Скопируйте полностью GEEXBOX дерево в ту же директорию (C:\tftpd32\GEEXBOX).

Старт tftpd32:
   - Выберите C:\tftpd32 папку для "текущей директории"
   - Выберите интерфейс (сетевую карту) для использования в "сервер интерфейс"
     В данном примере - это 192.168.0.1
   - Зайдите в "установки" и убедитесь, что DHCP сервер отмечен (включен)
   - В "DHCP сервер" закладке, заполните все поля, используя следующий пример:
   (Пожалуйста, сверьтесь с определенной документацией о DHCP в сети для лучшего понимания)
      - ip starting pool: 192.168.0.10
      - size of pool: 10
      - boot file: ./GEEXBOX/boot/pxelinux.0
      - wins/dns server: 192.168.0.254
      - sefault router: 192.168.0.254
      - mask: 255.255.255.0
      - domain name : mydomain.net
   - Кликните "save" для применения изменений.

Первая часть выполнена, Вы можете теперь загрузить клиентский компьютер (который запускает GeeXboX) и
просмотреть его загрузку до появления логотипа. Через некоторое время процесс замрет, потому что Ваш NFS сервер еще не установлен.
Установите "Allegro NFS server" и заполните все поля следуя таким установкам:

Экспортируемые закладки: 
   - Добавить "новое имя": и вызвать его "/tftpboot/GEEXBOX"
   - В "путь" как выше: выберите "C:\tftp32\GEEXBOX" папку
   - В "допускаемом host списке" , выберите "все"
   - "Чтение запись", и "читать только список пользователей", выберите "root" и "все"
   (если Вы желаете проводить определенный учет, достаточно отметить все в последней закладке)

Применение установок.
Не забудьте изменить файл C:\tftp32\GEEXBOX\boot\pxelinux.cfg\default и изменить ip адрес "192.168.0.2" на "192.168.0.1"
(или на один из предыдущих, установленных Вами).

Достаточно запустить клиентский компьютер и теперь GeeXboX должен заработать прекрасно.



Сборка.

Во-первых, посмотрите в конфигурационную секцию сразу под, по крайней мере, главной частью.
Затем, в основном, Вы можете построить iso с:
  make
Или Вы можете непосредственно прожечь этот iso с:
  make burn

После выполнения, Вы можете освободить дисковое пространство, путем очистки сборочного дерева:
  make clean
или посредством выполнения полной очистки, даже убрав загруженные исходные тексты:
  make distclean

Здесь есть также улучшенные команды, если Вы хотите подробнее разобраться с GeeXboX:
  scripts/get пакет            # загрузить пакет
  scripts/unpack пакет         # распаковать и подготовить пакет
  scripts/build пакет          # собрать пакет
  scripts/install пакет        # установить пакет с $INSTALL префиксом
  scripts/clean пакет          # очистить дерево сборки пакета
  scripts/clean --полный пакет # очистить оба: сборку и деревья исходных текстов пакета

Если Вы делаете подробную версию GeeXboX, Вы можете легко собрать маленький tar.bz2 для нее с:
  make dist
или полный tar (содержащий все исходные тексты) с:
  make fulldist
или geexbox генератор с:
  make generator
или geexbox установщик с:
  make installator
или pxe готовое дерево с:
  make pxe



Конфигурация.

Глобальные опции:
   Первая вещь, о которой Вы должны позаботиться, перед попыткой сборки GeeXboX, находиться в файле config/options,
   и должна быть сама по себе понятна.

Linux:
    Это классическая Linux конфигурация (packages/linux/linux.conf).
    Вы можете отредактировать ее в ручную, или Вы можете так же выполнить scripts/unpack linux,
    а затем make menuconfig -C build/linux-* (или использовать метод предпочитаемый Вами в отличии от menuconfig).
    Затем Вы должны дублировать Ваш build/linux-*/.config в packages/linux/linux.conf.

Lirc:
   Lirc позволяет Вам контролировать GeeXboX, используя пульт дистанционного управления. Во-первых Вы должны выбрать файл,
   соответствующий спецификации Вашего дистанционного управления build/lirc-*/remotes (после выполнения scripts/unpack lirc) и
   добавить его в packages/lirc/install. Затем Вы должны выбрать Ваше устройство (изначально это /dev/ttyS0 (COM1)) и lirc драйвер и
   поместить его в файл, называемый packages/lirc/lircd_$REMOTE.
   Затем Вы можете выбрать Вашу раскладку клавиш в файле packages/lirc/lircrc_$REMOTE.
   Для каждой раскладки Вы выбираете кнопку (их названия в файле определений дистанционного управления) и
   сопоставляете какое-либо действие для нее.
   Например, одно из действий Mplayer-а (Вы можете найти список в html файле build/MPlayer-*/DOCS/documentation.html#commands).



Разработка.

Первая вещь, на которую Вы должны обратить внимание - инициализационный скрипт. Фактически есть два инициализационных скрипта.
Первый в packages/initrd/linuxrc, но Вам не нужно изменять его. Второй - в config/init и в нем Вы можете задать некоторые настройки.

Следующая вещь, которая может заинтересовать Вас это создание нового "пакета". Пакет это всего лишь группа скриптов,
составленных в соответствии с определенными правилами. Все скрипты, располагаются в директории, называемой так же,
как и программа в директории пакета, которую Вы хотите сделать независимым "пакетом". Вот список скриптов, которые Вы можете создать:
   - url: всего лишь список адресов, где Вы получаете исходные тексты программы
   - unpack: что происходит после распаковки исходных текстов
   (например, Вы можете изменить определенные конфигурационные файлы; это не включает приложение патчей)
   - need_build: вызывается, когда необходимо убедиться, что уже собранный пакет не нуждается в пересборке;
   удалите файл .stamps/"package name"/build, если пакет нуждается в пересборке
   - build: все необходимые шаги для сборки программы
   - install: все необходимые шаги для установки; префикс установки должен быть $INSTALL

Когда файлы, полученные с указанных адресов называются patch-program_name-...
они автоматически применяются к распакованным исходным текстам программы.
Помните, что программное обеспечение, которое выполняется в GeeXboX, должно быть скомпилировано в uClibc gcc системе.

В завершении, лучший путь собрать пакет - это посмотреть, как собираются другие пакеты.



Лицензия.

Все программы, используемые в GeeXboX защищены их соответствующими лицензиями. Они все - 
свободное программное обеспечение и большинство из них защищено GNU General Public License.
GeeXboX сам-по-себе - это все скрипты, которые используются в сборочном процессе - защищен GNU General Public License.